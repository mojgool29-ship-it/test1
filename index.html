<!DOCTYPE html>
<html>
<head>
    <title>Telegram Stars Lottery</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="frame-ancestors https://web.telegram.org;">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: white;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .logo {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .subtitle {
            opacity: 0.8;
            font-size: 16px;
        }

        /* –ë–∞–ª–∞–Ω—Å Stars */
        .balance-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stars-balance {
            font-size: 42px;
            font-weight: bold;
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .star-icon {
            color: #FFD700;
            font-size: 36px;
            animation: glow 2s infinite;
        }

        @keyframes glow {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .balance-label {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        /* –ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫ */
        .bet-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .bet-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .bet-controls {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .bet-amount {
            font-size: 24px;
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .bet-buttons {
            display: flex;
            gap: 10px;
        }

        .bet-button {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            font-size: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .bet-button:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .bet-presets {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 15px;
        }

        .bet-preset {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            padding: 12px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .bet-preset:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .bet-preset.active {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #333;
            font-weight: bold;
        }

        /* –õ–æ—Ç–µ—Ä–µ—è */
        .lottery-section {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .slots-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 25px 0;
            perspective: 1000px;
        }

        .slot {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 36px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transform-style: preserve-3d;
            color: #333;
        }

        .slot.spinning {
            animation: spin 0.1s infinite linear;
        }

        @keyframes spin {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
        }

        .spin-button {
            background: linear-gradient(135deg, #FF6B6B, #EE5A24);
            color: white;
            border: none;
            padding: 18px 30px;
            font-size: 18px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            width: 100%;
            margin: 15px 0;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .spin-button:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .spin-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background: #666;
        }

        /* –†–µ–∑—É–ª—å—Ç–∞—Ç */
        .result-section {
            background: rgba(255, 255, 255, 0.15);
            border-radius: 15px;
            padding: 25px;
            margin: 20px 0;
            text-align: center;
            display: none;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-emoji {
            font-size: 60px;
            margin-bottom: 15px;
        }

        .result-title {
            font-size: 22px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .result-amount {
            font-size: 32px;
            font-weight: bold;
            color: #FFD700;
            margin: 10px 0;
        }

        .result-description {
            opacity: 0.9;
            line-height: 1.4;
        }

        /* –ü—Ä–∏–∑—ã */
        .prizes-section {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin-top: 20px;
        }

        .prizes-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }

        .prize-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 10px;
        }

        .prize-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .prize-emoji {
            font-size: 32px;
        }

        .prize-details h4 {
            margin-bottom: 5px;
        }

        .prize-details span {
            font-size: 12px;
            opacity: 0.8;
        }

        .prize-chance {
            font-size: 14px;
            color: #FFD700;
            font-weight: bold;
        }

        .notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 15px 25px;
            border-radius: 10px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.2);
            z-index: 1000;
            display: none;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo">üé∞</div>
            <div class="title">Stars Lottery</div>
            <div class="subtitle">–ö—Ä—É—Ç–∏ –ª–æ—Ç–µ—Ä–µ—é –∑–∞ Telegram Stars!</div>
        </div>

        <!-- –ë–∞–ª–∞–Ω—Å Stars -->
        <div class="balance-section">
            <div class="balance-label">–í–∞—à –±–∞–ª–∞–Ω—Å Telegram Stars</div>
            <div class="stars-balance">
                <span class="star-icon">‚≠ê</span>
                <span id="starsBalance">0</span>
            </div>
            <div class="balance-label" id="balanceValue">~ 0.00 USD</div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞–≤–æ–∫ -->
        <div class="bet-section">
            <div class="bet-title">–†–∞–∑–º–µ—Ä —Å—Ç–∞–≤–∫–∏</div>
            <div class="bet-controls">
                <div class="bet-amount">
                    <span>‚≠ê</span>
                    <span id="currentBet">10</span>
                </div>
                <div class="bet-buttons">
                    <button class="bet-button" onclick="changeBet(-1)">-</button>
                    <button class="bet-button" onclick="changeBet(1)">+</button>
                </div>
            </div>
            <div class="bet-presets">
                <button class="bet-preset" onclick="setBet(10)">10 ‚≠ê</button>
                <button class="bet-preset active" onclick="setBet(50)">50 ‚≠ê</button>
                <button class="bet-preset" onclick="setBet(100)">100 ‚≠ê</button>
            </div>
        </div>

        <!-- –õ–æ—Ç–µ—Ä–µ—è -->
        <div class="lottery-section">
            <div class="slots-container">
                <div class="slot" id="slot1">‚≠ê</div>
                <div class="slot" id="slot2">‚≠ê</div>
                <div class="slot" id="slot3">‚≠ê</div>
            </div>

            <button class="spin-button" id="spinButton" onclick="startLottery()">
                <span>üé∞</span>
                –ö–†–£–¢–ò–¢–¨ –ó–ê <span id="betAmount">10</span> ‚≠ê
            </button>
        </div>

        <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç -->
        <div class="result-section" id="resultSection">
            <div class="result-emoji" id="resultEmoji">üéâ</div>
            <div class="result-title" id="resultTitle">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</div>
            <div class="result-amount" id="resultAmount">+50 ‚≠ê</div>
            <div class="result-description" id="resultDescription">–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ Stars!</div>
        </div>

        <!-- –ü—Ä–∏–∑—ã -->
        <div class="prizes-section">
            <div class="prizes-title">–í–æ–∑–º–æ–∂–Ω—ã–µ –≤—ã–∏–≥—Ä—ã—à–∏</div>
            <div id="prizesList">
                <!-- –ü—Ä–∏–∑—ã –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
            </div>
        </div>
    </div>

    <div class="notification" id="notification"></div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();

        // –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        let userState = {
            starsBalance: 0,
            currentBet: 10,
            isSpinning: false
        };

        // –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏–∑—ã (—É–º–Ω–æ–∂–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏)
        const prizes = [
            { emoji: "üéâ", multiplier: 5, chance: 5, name: "–î–∂–µ–∫–ø–æ—Ç", description: "5x –æ—Ç —Å—Ç–∞–≤–∫–∏" },
            { emoji: "üí∞", multiplier: 3, chance: 15, name: "–ö—Ä—É–ø–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à", description: "3x –æ—Ç —Å—Ç–∞–≤–∫–∏" },
            { emoji: "‚≠ê", multiplier: 2, chance: 30, name: "–í—ã–∏–≥—Ä—ã—à", description: "2x –æ—Ç —Å—Ç–∞–≤–∫–∏" },
            { emoji: "üîî", multiplier: 1.5, chance: 25, name: "–ú–µ–ª–∫–∏–π –≤—ã–∏–≥—Ä—ã—à", description: "1.5x –æ—Ç —Å—Ç–∞–≤–∫–∏" },
            { emoji: "‚ö°", multiplier: 1.2, chance: 15, name: "–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—ã–∏–≥—Ä—ã—à", description: "1.2x –æ—Ç —Å—Ç–∞–≤–∫–∏" },
            { emoji: "üí∏", multiplier: 0, chance: 10, name: "–ü—Ä–æ–∏–≥—Ä—ã—à", description: "–°—Ç–∞–≤–∫–∞ –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è" }
        ];

        // –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–ª–∞–Ω—Å–∞ Stars –∏–∑ Telegram
        function loadStarsBalance() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ Telegram API
            // –î–ª—è –¥–µ–º–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –±–∞–ª–∞–Ω—Å
            const demoBalance = Math.floor(Math.random() * 1000);
            userState.starsBalance = demoBalance;
            updateBalanceDisplay();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –±–∞–ª–∞–Ω—Å–∞
        function updateBalanceDisplay() {
            document.getElementById('starsBalance').textContent = userState.starsBalance;
            document.getElementById('balanceValue').textContent = `~ ${(userState.starsBalance * 0.01).toFixed(2)} USD`;
            updateSpinButton();
        }

        // –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞–≤–∫–∏
        function changeBet(amount) {
            const newBet = userState.currentBet + amount;
            if (newBet >= 10 && newBet <= 1000) {
                userState.currentBet = newBet;
                updateBetDisplay();
            }
        }

        // –£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞–≤–∫–∏
        function setBet(amount) {
            userState.currentBet = amount;
            updateBetDisplay();

            // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—É—é –∫–Ω–æ–ø–∫—É
            document.querySelectorAll('.bet-preset').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å—Ç–∞–≤–∫–∏
        function updateBetDisplay() {
            document.getElementById('currentBet').textContent = userState.currentBet;
            document.getElementById('betAmount').textContent = userState.currentBet;
            updateSpinButton();
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –≤—Ä–∞—â–µ–Ω–∏—è
        function updateSpinButton() {
            const button = document.getElementById('spinButton');
            button.disabled = userState.isSpinning || userState.starsBalance < userState.currentBet;
        }

        // –ó–∞–ø—É—Å–∫ –ª–æ—Ç–µ—Ä–µ–∏
        function startLottery() {
            if (userState.isSpinning) return;

            if (userState.starsBalance < userState.currentBet) {
                showNotification('‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ Stars! –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å.');
                return;
            }

            // –°–ø–∏—Å—ã–≤–∞–µ–º Stars
            userState.starsBalance -= userState.currentBet;
            userState.isSpinning = true;
            updateBalanceDisplay();

            // –ê–Ω–∏–º–∞—Ü–∏—è –≤—Ä–∞—â–µ–Ω–∏—è
            const slots = document.querySelectorAll('.slot');
            slots.forEach(slot => slot.classList.add('spinning'));

            // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                const result = getLotteryResult();
                showResult(result);
                userState.isSpinning = false;
                updateBalanceDisplay();
            }, 2000);
        }

        // –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ª–æ—Ç–µ—Ä–µ–∏
        function getLotteryResult() {
            const random = Math.random() * 100;
            let accumulatedChance = 0;

            for (const prize of prizes) {
                accumulatedChance += prize.chance;
                if (random <= accumulatedChance) {
                    return prize;
                }
            }

            return prizes[prizes.length - 1]; // –ü—Ä–æ–∏–≥—Ä—ã—à
        }

        // –ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        function showResult(prize) {
            const winAmount = Math.floor(userState.currentBet * prize.multiplier);

            if (prize.multiplier > 0) {
                userState.starsBalance += winAmount;
                showNotification(`üéâ –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ ${winAmount} Stars!`);
            }

            document.getElementById('resultEmoji').textContent = prize.emoji;
            document.getElementById('resultTitle').textContent = prize.name;
            document.getElementById('resultAmount').textContent = prize.multiplier > 0 ? `+${winAmount} ‚≠ê` : '0 ‚≠ê';
            document.getElementById('resultDescription').textContent = prize.description;

            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–ª–æ—Ç–æ–≤
            const slots = document.querySelectorAll('.slot');
            slots.forEach(slot => {
                slot.classList.remove('spinning');
                slot.textContent = prize.emoji;
            });

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            document.getElementById('resultSection').style.display = 'block';

            // –ß–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã —Å–∫—Ä—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            setTimeout(() => {
                document.getElementById('resultSection').style.display = 'none';
                slots.forEach(slot => slot.textContent = '‚≠ê');
            }, 3000);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ –ø—Ä–∏–∑–æ–≤
        function loadPrizesList() {
            const prizesList = document.getElementById('prizesList');
            prizesList.innerHTML = '';

            prizes.forEach(prize => {
                const item = document.createElement('div');
                item.className = 'prize-item';

                item.innerHTML = `
                    <div class="prize-info">
                        <div class="prize-emoji">${prize.emoji}</div>
                        <div class="prize-details">
                            <h4>${prize.name}</h4>
                            <span>${prize.description}</span>
                        </div>
                    </div>
                    <div class="prize-chance">${prize.chance}%</div>
                `;

                prizesList.appendChild(item);
            });
        }

        // –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
        function showNotification(message) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.style.display = 'block';

            setTimeout(() => {
                notification.style.display = 'none';
            }, 3000);
        }

        // –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Telegram Stars API
        function initTelegramStars() {
            // –ü–æ–ª—É—á–∞–µ–º –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            if (Telegram.WebApp.initDataUnsafe?.user) {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ Telegram API
                console.log('User data:', Telegram.WebApp.initDataUnsafe.user);
            }

            // –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–ª–∞—Ç–µ–∂–µ–π
            Telegram.WebApp.onEvent('invoiceClosed', (event) => {
                if (event.status === 'paid') {
                    showNotification('‚úÖ Stars —É—Å–ø–µ—à–Ω–æ –ø–æ–ø–æ–ª–Ω–µ–Ω—ã!');
                    loadStarsBalance(); // –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –±–∞–ª–∞–Ω—Å
                }
            });
        }

        // –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ —á–µ—Ä–µ–∑ Telegram Payments
        function addStars() {
            // –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—É–¥–µ—Ç –≤—ã–∑–æ–≤ Telegram Payments
            showNotification('üîÑ –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã...');

            // –î–µ–º–æ-–ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ
            setTimeout(() => {
                userState.starsBalance += 100;
                updateBalanceDisplay();
                showNotification('‚úÖ +100 Stars –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ –±–∞–ª–∞–Ω—Å!');
            }, 1000);
        }

        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è —Ç–µ–º—ã
        function updateTheme() {
            if (Telegram.WebApp.colorScheme === 'dark') {
                document.body.style.background = 'linear-gradient(135deg, #2c3e50 0%, #34495e 100%)';
            }
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        loadStarsBalance();
        loadPrizesList();
        updateTheme();

        Telegram.WebApp.onEvent('themeChanged', updateTheme);
        Telegram.WebApp.onEvent('viewportChanged', updateTheme);

        // –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –≤ –±–∞–ª–∞–Ω—Å-—Å–µ–∫—Ü–∏—é
        const balanceSection = document.querySelector('.balance-section');
        const addButton = document.createElement('button');
        addButton.innerHTML = 'üí≥ –ü–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å';
        addButton.style = `
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #333;
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 15px;
            width: 100%;
        `;
        addButton.onclick = addStars;
        balanceSection.appendChild(addButton);
    </script>
</body>
</html>