<!DOCTYPE html>
<html>
<head>
    <title>Random Gift Bot</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="frame-ancestors https://web.telegram.org;">

    <style>
        body {
            margin: 0;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Arial', sans-serif;
            color: white;
            text-align: center;
        }

        .container {
            width: 100%;
            max-width: 400px;
        }

        .title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            font-size: 16px;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .slot-machine {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px 20px;
            margin-bottom: 30px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .slots-container {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            perspective: 1000px;
        }

        .slot {
            width: 80px;
            height: 80px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transform-style: preserve-3d;
            transition: transform 0.3s ease;
        }

        .slot.spinning {
            animation: spin 0.1s infinite linear;
        }

        @keyframes spin {
            0% { transform: rotateX(0deg); }
            100% { transform: rotateX(360deg); }
        }

        .spin-button {
            background: linear-gradient(135deg, #FFD700, #FFA500);
            color: #333;
            border: none;
            padding: 18px 40px;
            font-size: 20px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
            transition: all 0.3s ease;
            margin: 20px 0;
            width: 100%;
            max-width: 250px;
        }

        .spin-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6);
        }

        .spin-button:active {
            transform: translateY(0);
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.3);
        }

        .spin-button:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .result {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: none;
        }

        .result.show {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .prize-emoji {
            font-size: 50px;
            margin: 10px 0;
        }

        .prize-text {
            font-size: 18px;
            font-weight: bold;
            margin: 10px 0;
        }

        .prize-description {
            font-size: 14px;
            opacity: 0.9;
        }

        .attempts {
            font-size: 14px;
            margin: 10px 0;
            opacity: 0.8;
        }

        .history {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 15px;
            margin-top: 20px;
            max-height: 150px;
            overflow-y: auto;
        }

        .history-title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-emoji {
            font-size: 20px;
        }

        .history-prize {
            font-size: 14px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="title">üéÅ –°–ª—É—á–∞–π–Ω—ã–π –ü–æ–¥–∞—Ä–æ–∫</div>
        <div class="subtitle">–ö—Ä—É—Ç–∏ —Å–ª–æ—Ç—ã –∏ –≤—ã–∏–≥—Ä—ã–≤–∞–π –ø—Ä–∏–∑—ã!</div>

        <div class="slot-machine">
            <div class="slots-container">
                <div class="slot" id="slot1">üéÆ</div>
                <div class="slot" id="slot2">üéØ</div>
                <div class="slot" id="slot3">üé®</div>
            </div>

            <button class="spin-button" id="spinButton" onclick="spinSlots()">
                üé∞ –ö–†–£–¢–ò–¢–¨! üé∞
            </button>

            <div class="attempts">–ü–æ–ø—ã—Ç–æ–∫ —Å–µ–≥–æ–¥–Ω—è: <span id="attemptsCount">3</span></div>
        </div>

        <div class="result" id="result">
            <div class="prize-emoji" id="prizeEmoji">üéÅ</div>
            <div class="prize-text" id="prizeText">–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!</div>
            <div class="prize-description" id="prizeDescription">–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏ –ø–æ–¥–∞—Ä–æ–∫!</div>
        </div>

        <div class="history">
            <div class="history-title">–ò—Å—Ç–æ—Ä–∏—è –≤—ã–∏–≥—Ä—ã—à–µ–π</div>
            <div id="historyList"></div>
        </div>
    </div>

    <script>
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App
        Telegram.WebApp.ready();
        Telegram.WebApp.expand();

        // –°–ø–∏—Å–æ–∫ –≤–æ–∑–º–æ–∂–Ω—ã—Ö –ø—Ä–∏–∑–æ–≤
        const prizes = [
            { emoji: "üéÆ", name: "–ò–≥—Ä–æ–≤–∞—è –∫–æ–Ω—Å–æ–ª—å", description: "–í–∏—Ä—Ç—É–∞–ª—å–Ω–∞—è –∏–≥—Ä–æ–≤–∞—è –ø—Ä–∏—Å—Ç–∞–≤–∫–∞", rarity: "rare" },
            { emoji: "üéØ", name: "–î–∞—Ä—Ç—Å", description: "–ù–∞–±–æ—Ä –¥–ª—è –º–µ—Ç–∞–Ω–∏—è –¥—Ä–æ—Ç–∏–∫–æ–≤", rarity: "common" },
            { emoji: "üé®", name: "–ù–∞–±–æ—Ä —Ö—É–¥–æ–∂–Ω–∏–∫–∞", description: "–ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∫–∏—Å—Ç–∏ –∏ –∫—Ä–∞—Å–∫–∏", rarity: "uncommon" },
            { emoji: "üé∏", name: "–ì–∏—Ç–∞—Ä–∞", description: "–≠–ª–µ–∫—Ç—Ä–æ–≥–∏—Ç–∞—Ä–∞ –¥–ª—è —Ä–æ–∫-–∑–≤–µ–∑–¥—ã", rarity: "rare" },
            { emoji: "üèÜ", name: "–ö—É–±–æ–∫ —á–µ–º–ø–∏–æ–Ω–∞", description: "–ó–æ–ª–æ—Ç–æ–π —Ç—Ä–æ—Ñ–µ–π –ø–æ–±–µ–¥–∏—Ç–µ–ª—è", rarity: "epic" },
            { emoji: "üì±", name: "–°–º–∞—Ä—Ç—Ñ–æ–Ω", description: "–ù–æ–≤–µ–π—à–∞—è –º–æ–¥–µ–ª—å —Ç–µ–ª–µ—Ñ–æ–Ω–∞", rarity: "epic" },
            { emoji: "üíé", name: "–ê–ª–º–∞–∑", description: "–î—Ä–∞–≥–æ—Ü–µ–Ω–Ω—ã–π –∫–∞–º–µ–Ω—å", rarity: "legendary" },
            { emoji: "üöó", name: "–°–ø–æ—Ä—Ç–∫–∞—Ä", description: "–†–æ—Å–∫–æ—à–Ω—ã–π –∞–≤—Ç–æ–º–æ–±–∏–ª—å", rarity: "legendary" },
            { emoji: "üé™", name: "–¶–∏—Ä–∫", description: "–ë–∏–ª–µ—Ç—ã –Ω–∞ —Ü–∏—Ä–∫–æ–≤–æ–µ —à–æ—É", rarity: "uncommon" },
            { emoji: "üé≠", name: "–¢–µ–∞—Ç—Ä", description: "–ü—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –Ω–∞ –ø—Ä–µ–º—å–µ—Ä—É", rarity: "common" }
        ];

        let attempts = 3;
        let isSpinning = false;
        let history = [];

        function spinSlots() {
            if (isSpinning || attempts <= 0) return;

            isSpinning = true;
            attempts--;
            document.getElementById('attemptsCount').textContent = attempts;
            document.getElementById('spinButton').disabled = true;
            document.getElementById('result').classList.remove('show');

            // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é —Å–ª–æ—Ç–æ–≤
            const slots = document.querySelectorAll('.slot');
            slots.forEach(slot => slot.classList.add('spinning'));

            // –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –ø—Ä–∏–∑–∞
            const randomPrize = prizes[Math.floor(Math.random() * prizes.length)];

            // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–ª–æ—Ç—ã —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                slots.forEach(slot => slot.classList.remove('spinning'));

                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–∏–≥—Ä—ã—à
                setTimeout(() => showResult(randomPrize), 500);
            }, 2000);
        }

        function showResult(prize) {
            const resultDiv = document.getElementById('result');
            document.getElementById('prizeEmoji').textContent = prize.emoji;
            document.getElementById('prizeText').textContent = prize.name;
            document.getElementById('prizeDescription').textContent = prize.description;

            // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
            addToHistory(prize);

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            resultDiv.classList.add('show');

            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É, –µ—Å–ª–∏ –µ—Å—Ç—å –ø–æ–ø—ã—Ç–∫–∏
            if (attempts > 0) {
                isSpinning = false;
                document.getElementById('spinButton').disabled = false;
            }

            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ Telegram (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
            sendToTelegram(prize);
        }

        function addToHistory(prize) {
            history.unshift(prize);
            if (history.length > 5) history.pop();

            const historyList = document.getElementById('historyList');
            historyList.innerHTML = '';

            history.forEach((item, index) => {
                const historyItem = document.createElement('div');
                historyItem.className = 'history-item';
                historyItem.innerHTML = `
                    <span class="history-emoji">${item.emoji}</span>
                    <span class="history-prize">${item.name}</span>
                    <span class="history-date">${new Date().toLocaleTimeString()}</span>
                `;
                historyList.appendChild(historyItem);
            });
        }

        function sendToTelegram(prize) {
            // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –≤ Telegram –±–æ—Ç–∞
            // –ù–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ Telegram.WebApp.sendData()
            console.log('–í—ã–∏–≥—Ä—ã—à:', prize);

            // –ü—Ä–∏–º–µ—Ä –æ—Ç–ø—Ä–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö –±–æ—Ç—É
            // Telegram.WebApp.sendData(JSON.stringify({
            //     type: 'prize_won',
            //     prize: prize.name,
            //     emoji: prize.emoji
            // }));
        }

        // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ç–µ–º—É Telegram
        function updateTheme() {
            if (Telegram.WebApp.colorScheme === 'dark') {
                document.body.style.background = 'linear-gradient(135deg, #2c3e50 0%, #34495e 100%)';
            } else {
                document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }
        }

        updateTheme();
        Telegram.WebApp.onEvent('themeChanged', updateTheme);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏
        addToHistory();
    </script>
</body>
</html>